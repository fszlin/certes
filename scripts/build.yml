
parameters:
  name: ''
  displayName: ''
  pool: ''
  framework: ''
  appFramework: ''

jobs:
- job: ${{ parameters.name }}
  displayName: ${{ parameters.displayName }}
  pool: ${{ parameters.pool }}

  steps:

  - task: UseDotNet@2
    displayName: 'use sdk v2.2'
    inputs:
      packageType: sdk
      version: 2.2.x
      
  - task: DotNetCoreCLI@2
    displayName: 'build certes'
    inputs:
      command: 'build'
      projects: 'src/Certes/Certes.csproj'
      arguments: '-f ${{ parameters.framework }}'

  - task: DotNetCoreCLI@2
    displayName: 'run unit tests'
    inputs:
      command: 'test'
      projects: 'test/Certes.Tests/Certes.Tests.csproj'
      arguments: '-f ${{ parameters.appFramework }} --collect "Code Coverage"'
      testRunTitle: 'Unit Tests'

  - task: DotNetCoreCLI@2
    displayName: 'run integration tests'
    inputs:
      command: 'test'
      projects: 'test/Certes.Tests.Integration/Certes.Tests.Integration.csproj --collect "Code Coverage"'
      arguments: '-f ${{ parameters.appFramework }}'
      testRunTitle: 'Integration Tests'

